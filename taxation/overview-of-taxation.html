<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Guidelines | Overview of taxation</title>
    <meta name="description" content="Developer Guides for Solidus">
    <link rel="shortcut icon" href="/solidus/favicon.ico">
  <link rel="apple-touch-icon" href="/solidus/apple-touch-icon.png">
    
    <link rel="preload" href="/solidus/assets/css/73.styles.eab8b2ae.css" as="style"><link rel="preload" href="/solidus/assets/js/app.8a40fd93.js" as="script"><link rel="preload" href="/solidus/assets/js/8.9360dac4.js" as="script"><link rel="prefetch" href="/solidus/assets/js/37.b74e6c67.js"><link rel="prefetch" href="/solidus/assets/js/1.bc8aaa90.js"><link rel="prefetch" href="/solidus/assets/js/2.d4e88151.js"><link rel="prefetch" href="/solidus/assets/js/3.e88dfa7e.js"><link rel="prefetch" href="/solidus/assets/js/4.7b7ea6ef.js"><link rel="prefetch" href="/solidus/assets/js/5.8bb30487.js"><link rel="prefetch" href="/solidus/assets/js/6.6430c6fd.js"><link rel="prefetch" href="/solidus/assets/js/7.573fb1d2.js"><link rel="prefetch" href="/solidus/assets/js/9.bc0513d0.js"><link rel="prefetch" href="/solidus/assets/js/10.9de329d0.js"><link rel="prefetch" href="/solidus/assets/js/11.3ef794fe.js"><link rel="prefetch" href="/solidus/assets/js/12.a9f19247.js"><link rel="prefetch" href="/solidus/assets/js/13.10bdcfc3.js"><link rel="prefetch" href="/solidus/assets/js/14.baeb49cf.js"><link rel="prefetch" href="/solidus/assets/js/15.4d27d13f.js"><link rel="prefetch" href="/solidus/assets/js/16.4dbd3af2.js"><link rel="prefetch" href="/solidus/assets/js/17.96a840b0.js"><link rel="prefetch" href="/solidus/assets/js/18.7af603a9.js"><link rel="prefetch" href="/solidus/assets/js/19.944f2391.js"><link rel="prefetch" href="/solidus/assets/js/20.0d3a03ca.js"><link rel="prefetch" href="/solidus/assets/js/21.6f8a3623.js"><link rel="prefetch" href="/solidus/assets/js/22.1ab16961.js"><link rel="prefetch" href="/solidus/assets/js/23.c5a09552.js"><link rel="prefetch" href="/solidus/assets/js/24.01d33ebc.js"><link rel="prefetch" href="/solidus/assets/js/25.368e20d3.js"><link rel="prefetch" href="/solidus/assets/js/26.0ff243dc.js"><link rel="prefetch" href="/solidus/assets/js/27.379ef86c.js"><link rel="prefetch" href="/solidus/assets/js/28.b1d94d4e.js"><link rel="prefetch" href="/solidus/assets/js/29.a582c0f5.js"><link rel="prefetch" href="/solidus/assets/js/30.75b3694e.js"><link rel="prefetch" href="/solidus/assets/js/31.32737bfe.js"><link rel="prefetch" href="/solidus/assets/js/32.68e6e17c.js"><link rel="prefetch" href="/solidus/assets/js/33.1e8efaaa.js"><link rel="prefetch" href="/solidus/assets/js/34.349d8482.js"><link rel="prefetch" href="/solidus/assets/js/35.78fdbd6e.js"><link rel="prefetch" href="/solidus/assets/js/36.0b2759fa.js"><link rel="prefetch" href="/solidus/assets/js/0.594398bd.js"><link rel="prefetch" href="/solidus/assets/js/38.bccdd185.js"><link rel="prefetch" href="/solidus/assets/js/39.ad7f257e.js"><link rel="prefetch" href="/solidus/assets/js/40.18604395.js"><link rel="prefetch" href="/solidus/assets/js/41.0e64d55c.js"><link rel="prefetch" href="/solidus/assets/js/42.83301a40.js"><link rel="prefetch" href="/solidus/assets/js/43.f596cdc7.js"><link rel="prefetch" href="/solidus/assets/js/44.07f48a7c.js"><link rel="prefetch" href="/solidus/assets/js/45.a59da533.js"><link rel="prefetch" href="/solidus/assets/js/46.adca66b1.js"><link rel="prefetch" href="/solidus/assets/js/47.61b9b3b8.js"><link rel="prefetch" href="/solidus/assets/js/48.94da6411.js"><link rel="prefetch" href="/solidus/assets/js/49.045da191.js"><link rel="prefetch" href="/solidus/assets/js/50.4aa1c95a.js"><link rel="prefetch" href="/solidus/assets/js/51.3f25a7cb.js"><link rel="prefetch" href="/solidus/assets/js/52.7fc3e97e.js"><link rel="prefetch" href="/solidus/assets/js/53.478f3a20.js"><link rel="prefetch" href="/solidus/assets/js/54.bee46771.js"><link rel="prefetch" href="/solidus/assets/js/55.d22fc5aa.js"><link rel="prefetch" href="/solidus/assets/js/56.2779de7d.js"><link rel="prefetch" href="/solidus/assets/js/57.9229e917.js"><link rel="prefetch" href="/solidus/assets/js/58.53b44760.js"><link rel="prefetch" href="/solidus/assets/js/59.b4ab94d2.js"><link rel="prefetch" href="/solidus/assets/js/60.024d7dba.js"><link rel="prefetch" href="/solidus/assets/js/61.c0c81db2.js"><link rel="prefetch" href="/solidus/assets/js/62.9766010b.js"><link rel="prefetch" href="/solidus/assets/js/63.a22ac1c9.js"><link rel="prefetch" href="/solidus/assets/js/64.711f7334.js"><link rel="prefetch" href="/solidus/assets/js/65.0f534f00.js"><link rel="prefetch" href="/solidus/assets/js/66.e38c54e1.js"><link rel="prefetch" href="/solidus/assets/js/67.a395f431.js"><link rel="prefetch" href="/solidus/assets/js/68.f86e2d51.js"><link rel="prefetch" href="/solidus/assets/js/69.6f1fc43a.js"><link rel="prefetch" href="/solidus/assets/js/70.944af6a0.js"><link rel="prefetch" href="/solidus/assets/js/71.1f9a1de8.js"><link rel="prefetch" href="/solidus/assets/js/72.3e4d2c2a.js">
    <link rel="stylesheet" href="/solidus/assets/css/73.styles.eab8b2ae.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/solidus/" class="home-link router-link-active"><img src="/solidus/logo.svg" class="logo"><span class="site-name can-hide">
      Guidelines
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/solidus/" class="nav-link">Home</a></div><a href="https://github.com/solidusio/solidus" target="_blank" rel="noopener noreferrer" class="github-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/solidus/" class="nav-link">Home</a></div><a href="https://github.com/solidusio/solidus" target="_blank" rel="noopener noreferrer" class="github-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Getting Started</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Preferences</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Locations</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Payments</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Taxation</span><span class="arrow up"></span></p><ul class="sidebar-group-items"><li><a href="/solidus/taxation/overview-of-taxation.html" class="active sidebar-link">Overview of taxation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/solidus/taxation/overview-of-taxation.html#tax-categories" class="sidebar-link">Tax categories</a></li><li class="sidebar-sub-header"><a href="/solidus/taxation/overview-of-taxation.html#tax-rates" class="sidebar-link">Tax rates</a></li><li class="sidebar-sub-header"><a href="/solidus/taxation/overview-of-taxation.html#tax-addresses" class="sidebar-link">Tax addresses</a></li><li class="sidebar-sub-header"><a href="/solidus/taxation/overview-of-taxation.html#sales-tax-and-value-added-tax" class="sidebar-link">Sales tax and value-added tax</a></li><li class="sidebar-sub-header"><a href="/solidus/taxation/overview-of-taxation.html#order-taxation" class="sidebar-link">Order taxation</a></li></ul></li><li><a href="/solidus/taxation/displaying-prices.html" class="sidebar-link">Displaying prices</a></li><li><a href="/solidus/taxation/value-added-tax.html" class="sidebar-link">Value-added tax (VAT)</a></li><li><a href="/solidus/taxation/example-tax-setups.html" class="sidebar-link">Example tax setups</a></li><li><a href="/solidus/taxation/custom-tax-calculators.html" class="sidebar-link">Custom tax calculators</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Shipments</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Calculators</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Assets</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Views</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Products and Variants</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Inventory</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Returns</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Promotions</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Adjustments</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Orders</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Returns</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Users</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Upgrades</span><span class="arrow down"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Extensions</span><span class="arrow down"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="overview-of-taxation"><a href="#overview-of-taxation" aria-hidden="true" class="header-anchor">#</a> Overview of taxation</h1><p>Solidus's taxation system supports both sales- and VAT-style taxes. You can use
tax rates, tax categories, and the built-in tax calculator to handle your
store's tax logic. Solidus uses the <code>Spree::Adjustment</code> model to apply taxes to
orders. This way, there can be multiple tax adjustments applied to each order.</p><p>Using adjustments helps account for some of the complexities of tax, especially
if a store sells internationally:</p><ul><li>Orders may include products with different tax categories or rates.</li><li>Shipments may require special calculations if you are shipping to or from
locations where there are specific taxation rules for shipments.</li><li>Taxes may or may not be included in a product's price price depending on a
country's taxation rules.</li></ul><p>Solidus uses the <code>Spree::TaxCategory</code> and <code>Spree::TaxRate</code> models to specify the
rules for how tax adjustments are calculated. Tax adjustments are created for
each line item in an order.</p><p>See the <a href="#order-taxation">Order taxation</a> section for an overview of the order
taxation process.</p><h2 id="tax-categories"><a href="#tax-categories" aria-hidden="true" class="header-anchor">#</a> Tax categories</h2><p>Tax categories can be used to ensure particular products are taxed as required.
For example, if your business is based in Minnesota, you need to charge tax on
tech products but do not need to charge tax on clothing. You could set up two
tax categories, <strong>Clothing</strong> and <strong>Tech</strong> which you would apply to products of
either type.</p><p>By default, new products do not have a set tax category. Administrators can set
the tax category while creating the product or set it later while editing the
product.</p><h2 id="tax-rates"><a href="#tax-rates" aria-hidden="true" class="header-anchor">#</a> Tax rates</h2><p>Tax rates define the amount of tax that should be charged on items. You might
configure different tax rates for different zones and tax categories, or even
for specific dates. You could also create more complex tax rates with a custom
tax calculator.</p><p>In Solidus, a tax rate consists of at least four values:</p><ul><li>The descriptive name for the tax rate. For example, &quot;Minnesota Sales Tax&quot; for
a Minnesota state tax rate.</li><li>The zone that the tax rate should apply to. </li><li>The rate (in the form of a percentage of the price).</li><li>The &quot;Included in price&quot; boolean. This indicates whether the tax is included in
the price (for value-added taxes) or added to the price (U.S. taxes).</li></ul><p>Solidus calculates tax based on the matching tax rate(s) for the order's <a href="#tax-addresses">tax
address</a>.</p><h2 id="tax-addresses"><a href="#tax-addresses" aria-hidden="true" class="header-anchor">#</a> Tax addresses</h2><p>If an order's <code>tax_address</code> falls within a specific zone, the tax rates that you
have configured would apply for all the line items and shipments in that zone
that have a matching tax category.</p><p>By default, the <code>tax_address</code> used for orders is the customer's shipping
address. This is how most tax jurisdictions require taxes to be calculated.
However, you can configure your store to globally use customer billing
addresses instead in any initializer file inside the <code>config/initializers/</code>
directory:</p><pre class="language-ruby"><code><span class="token constant">Spree</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Config</span><span class="token punctuation">[</span><span class="token symbol">:tax_using_ship_address</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">true</span>
</code></pre><h3 id="use-spree-taxlocation-as-the-tax-address"><a href="#use-spree-taxlocation-as-the-tax-address" aria-hidden="true" class="header-anchor">#</a> Use <code>Spree::TaxLocation</code> as the tax address</h3><p>An order's <code>tax_address</code> can – through <a href="https://en.wikipedia.org/wiki/Duck_typing" target="_blank" rel="noopener noreferrer">duck typing</a> – be a
<code>Spree::TaxLocation</code> instead of the shipping address. The tax location is
computed from the store's <code>Spree.config.cart_tax_country_iso</code> setting.</p><p>Note that you can only trust the tax address it is has a country. The other
address fields might be empty or raise errors.</p><h2 id="sales-tax-and-value-added-tax"><a href="#sales-tax-and-value-added-tax" aria-hidden="true" class="header-anchor">#</a> Sales tax and value-added tax</h2><p>In ecommerce, <a href="https://en.wikipedia.org/wiki/Consumption_tax" target="_blank" rel="noopener noreferrer">consumption tax</a> either takes the form of sales
tax or value-added tax. Some countries use other names for their taxes, but
generally all modern consumption taxes would be considered one of these two
types.</p><p>Solidus's models support both types of taxes. In the case of a product or
shipment:</p><ul><li><strong>Sales tax</strong> is calculated as <em>additional</em> taxes on top of the listed price.
(U.S.-style taxation.)</li><li><strong>Value-added tax (VAT)</strong> is calculated as <em>included</em> in the listed price.
Solidus lists all VAT amounts below the item total on checkout summary pages.
For more information about VAT, see <a href="/solidus/taxation/value-added-tax.html">Value-added tax (VAT)</a>.</li></ul><h3 id="tax-in-the-united-states"><a href="#tax-in-the-united-states" aria-hidden="true" class="header-anchor">#</a> Tax in the United States</h3><p>Note that sales tax in the United States can get exceptionally complex. Each
state, county, and municipality might have a different tax rate.</p><p>If you intend to ship products between states, and your store is based in the
United States, we recommend that you use an external service like
<a href="https://www.avalara.com/" target="_blank" rel="noopener noreferrer">Avatax</a> or <a href="https://taxcloud.net/" target="_blank" rel="noopener noreferrer">Tax Cloud</a> to automate your U.S. tax rates.
Solidus has extensions for both of these services:
<a href="https://github.com/boomerdigital/solidus_avatax_certified" target="_blank" rel="noopener noreferrer"><code>solidus_avatax_certified</code></a> and
<a href="https://github.com/solidusio-contrib/solidus_tax_cloud" target="_blank" rel="noopener noreferrer"><code>solidus_tax_cloud</code></a>.</p><h2 id="order-taxation"><a href="#order-taxation" aria-hidden="true" class="header-anchor">#</a> Order taxation</h2><p>Once the order has a <code>tax_address</code> specified, tax can be calculated for all of
the line items and shipments associated with a <code>Spree::Order</code>:</p><p>Note that any promotional adjustments are applied before tax adjustments. This
is to comply with tax regulations for value-added taxation <a href="https://www.gov.uk/vat-businesses/discounts-and-free-gifts#1" target="_blank" rel="noopener noreferrer">as outlined by the
Government of the United Kingdom</a> and for sales tax <a href="http://www.boe.ca.gov/formspubs/pub113/" target="_blank" rel="noopener noreferrer">as
outlined by the California State Board of Equalization</a>.</p><ol><li>Solidus iterates over all of the order's line items. It selects the
tax rates that match each item's tax category.</li><li>For each line item, the tax rate (a percentage value) is multiplied with the
item's <code>amount</code> value. (<code>price ✕ quantity ➖ promotions</code>.)</li><li>The calculated amounts are stored in a <code>Spree::Adjustment</code> object that is
associated with the order's ID.</li><li>The line item's <code>included_tax_total</code> or <code>additional_tax_total</code> are updated.
(If the <code>Spree::TaxRate</code>'s <code>included_in_price</code> value is set to <code>true</code>,
Solidus uses the <code>included_tax_total</code> column to store the sum of VAT-style
taxes. Otherwise, it uses the <code>additional_tax_total</code> to store the sum of
sales tax-style taxes.)</li><li>The same process is executed on the order's <code>Spree::Shipments</code>.</li><li>The sum of the <code>included_tax_total</code> and <code>additional_tax_total</code> on all line
items and shipments a stored in the order's <code>included_tax_total</code> and
<code>additional_tax_total</code> values.</li></ol><p>The <code>included_tax_total</code> column does not affect the order's total, while the
<code>additional_tax_total</code> does.</p><p>Every time an order is changed, the taxation system checks whether tax
adjustments need to be changed and updates all of the taxation-relevant totals.</p><p>See the <a href="https://github.com/solidusio/solidus/blob/master/core/spec/models/spree/tax/taxation_integration_spec.rb" target="_blank" rel="noopener noreferrer">taxation integration spec</a> for more information on
Solidus's taxation system.</p></div><div class="content edit-link"><a href="https://github.com/solidusio/solidus/edit/master/guides/taxation/overview-of-taxation.md" target="_blank" rel="noopener noreferrer">Edit this page</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/solidus/payments/custom_gateway.html" class="prev">
          Building a custom gateway
        </a></span><span class="next"><a href="/solidus/taxation/displaying-prices.html">
          Displaying prices
        </a> →
      </span></p></div></div></div></div>
    <script src="/solidus/assets/js/8.9360dac4.js" defer></script><script src="/solidus/assets/js/app.8a40fd93.js" defer></script>
  </body>
</html>
