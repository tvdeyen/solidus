(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{64:function(t,e,s){"use strict";s.r(e);var n=s(0),a=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._m(1),s("p",[t._v("An example of a typical promotion rule would be a minimum order total of $75\nUSD or that a specific product is in the cart at checkout.")]),s("p",[t._v("Many conventional types of promotion rules are included by default. Multiple\npromotion rules can exist on each promotion, although no rules are required.")]),t._m(2),t._m(3),t._m(4),t._m(5),s("p",[t._v("Note that whenever an order, line item, or shipment with a promotion adjustment\non it is updated, the "),s("router-link",{attrs:{to:"overview.html#eligibility"}},[t._v("eligibility")]),t._v(" of the promotion is re-checked,\nand the adjustment is recalculated if necessary.")],1),t._m(6),t._m(7),s("p",[t._v('Administrators can change the match policy when adding or editing a promotion.\nBy default, promotions use the "Match all of these rules" setting, but they can\nbe changed to use "Match any of these rules".')]),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"promotion-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#promotion-rules","aria-hidden":"true"}},[this._v("#")]),this._v(" Promotion rules")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("code",[this._v("Spree::PromotionRule")]),this._v(" model sets a rule that determines whether a promotion\nis eligible to be applied. Promotions may have no rules or many different rules.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"available-promotion-rule-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#available-promotion-rule-types","aria-hidden":"true"}},[this._v("#")]),this._v(" Available promotion rule types")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The following classes are "),e("a",{attrs:{href:"https://github.com/solidusio/solidus/tree/master/core/app/models/spree/promotion/rules",target:"_blank",rel:"noopener noreferrer"}},[this._v("subclasses of the "),e("code",[this._v("Spree::Promotion::Rules")]),this._v("\nmodel")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("FirstOrder")]),t._v(": Eligible for a customer's first order only.")]),s("li",[s("code",[t._v("FirstRepeatPurchaseSince")]),t._v(": Eligible for a customer's first repeat purchase\nsince a specified date.")]),s("li",[s("code",[t._v("NthOrder")]),t._v(": Eligible for a customer's "),s("em",[t._v("n")]),t._v("th order only.")]),s("li",[s("code",[t._v("ItemTotal")]),t._v(": Eligible if the order total (before any adjustments) is less than\nor greater than a specified amount.")]),s("li",[s("code",[t._v("OneUsePerUser")]),t._v(": Eligible for use one time for each user.")]),s("li",[s("code",[t._v("Product")]),t._v(": Eligible for specified products only.")]),s("li",[s("code",[t._v("OptionValue")]),t._v(": Eligible for specified variants (product option values) only.")]),s("li",[s("code",[t._v("Taxon")]),t._v(": Eligible for products with specified taxons.")]),s("li",[s("code",[t._v("User")]),t._v(": Eligible for specified users.")]),s("li",[s("code",[t._v("UserRole")]),t._v(": Eligible for users with the specified user role.")]),s("li",[s("code",[t._v("UserLoggedIn")]),t._v(": Eligible for users who are logged in.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"eligibility"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eligibility","aria-hidden":"true"}},[this._v("#")]),this._v(" Eligibility")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"rules-match-policy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-match-policy","aria-hidden":"true"}},[this._v("#")]),this._v(" Rules match policy")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("By default, "),s("code",[t._v("Spree::Promotion")]),t._v("s have a "),s("code",[t._v("match_policy")]),t._v(" value of "),s("code",[t._v("all")]),t._v(", meaning\nthat all of the promotion rules on a promotion must be met before the promotion\nis eligible. However, this can be changed to "),s("code",[t._v("any")]),t._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"register-a-custom-promotion-rule"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-a-custom-promotion-rule","aria-hidden":"true"}},[this._v("#")]),this._v(" Register a custom promotion rule")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You can create a custom promotion rule by creating a new class that inherits\nfrom "),e("code",[this._v("Spree::PromotionRule")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("pre",{pre:!0,attrs:{class:"language-ruby"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("# app/models/spree/promotion/rules/my_promotion_rule.rb")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("module")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Spree")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Promotion")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("module")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Rules")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MyPromotionRule")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Spree")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token constant"}},[t._v("PromotionRule")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" applicable"),s("span",{attrs:{class:"token operator"}},[t._v("?")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("promotable"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          promotable"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("is_a"),s("span",{attrs:{class:"token operator"}},[t._v("?")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token constant"}},[t._v("Spree")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token constant"}},[t._v("Order")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" eligible"),s("span",{attrs:{class:"token operator"}},[t._v("?")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" actionable"),s("span",{attrs:{class:"token operator"}},[t._v("?")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("line_item"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n      "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Note that the "),e("code",[this._v("applicable?")]),this._v(" and "),e("code",[this._v("eligible?")]),this._v(" are required:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("eligible?")]),t._v(" should return "),s("code",[t._v("true")]),t._v(" or "),s("code",[t._v("false")]),t._v(" to indicate if the promotion is\neligible for an order.")]),s("li",[t._v("If your promotion supports discounts for some line items but not others,\ndefine "),s("code",[t._v("actionable?")]),t._v(" to return "),s("code",[t._v("true")]),t._v(" when the specified line item meets the\ncriteria for the promotion. It should return "),s("code",[t._v("true")]),t._v(" or "),s("code",[t._v("false")]),t._v(" to indicate if\nthis line item can have a line item adjustment carried out on it.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("For example, if you are giving a promotion on specific products only,\n"),e("code",[this._v("eligible?")]),this._v(" should return true if the order contains one of the products\neligible for promotion, and "),e("code",[this._v("actionable?")]),this._v(" should return true when the line item\nspecified is one of the specific products for this promotion.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Note that you can retrieve the associated "),e("code",[this._v("Spree::Promotion")]),this._v(" information by\ncalling the "),e("code",[this._v("promotion")]),this._v(" method.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You must then register the custom rule in an initializer in your\n"),e("code",[this._v("config/initializers/")]),this._v(" directory:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("pre",{pre:!0,attrs:{class:"language-ruby"}},[s("code",[s("span",{attrs:{class:"token constant"}},[t._v("Rails")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("application"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spree"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("promotions"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules "),s("span",{attrs:{class:"token operator"}},[t._v("<")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("MyPromotionRule")]),t._v("\n")])])}],!1,null,null,null);e.default=a.exports}}]);