(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{105:function(t,a,e){"use strict";e.r(a);var s=e(0),n=Object(s.a)({},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"content"},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),e("p",[t._v("Each "),e("code",[t._v("Spree::Calculator")]),t._v(" has "),e("router-link",{attrs:{to:"../preferences/add-model-preferences.html"}},[t._v("static model preferences")]),t._v(". Each\ninstances of a calculator has a "),e("code",[t._v("preferences")]),t._v(" attribute that stores a hash of\npreferences.")],1),t._m(16),t._m(17),e("p",[t._v("Because each type of calculator has different functionality, each calculator has its own\nset of preferences.")]),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),t._m(23),e("p",[t._v("If Solidus's built-in calculators are not sufficient for your store, you can\ncreate your own custom calculators. Because promotion, shipping, and tax\ncalculators have different requirements, we have an article describing each type\nof custom calculator you may want to build:")]),e("ul",[e("li",[t._v("Custom promotions calculator [Note: work in progress]")]),e("li",[e("router-link",{attrs:{to:"../shipments/custom-shipping-calculators.html"}},[t._v("Custom shipping calculators")])],1),e("li",[e("router-link",{attrs:{to:"../taxation/custom-tax-calculators.html"}},[t._v("Custom tax calculators")])],1)])])},[function(){var t=this.$createElement,a=this._self._c||t;return a("h1",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[this._v("#")]),this._v(" Overview")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("All calculators in Solidus inherit from the "),a("code",[this._v("Spree::Calculator")]),this._v(" base class. They\ncalculate and return the value of promotions, taxes, and shipping charges.\nSolidus includes built-in calculators for common types of calculations, such as\nflat rate shipping, percentage discounts, sales tax, and value-added tax (VAT).")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("Whenever you create a new shipping method, tax rate, or promotion action, you\nalso create a new instance of a "),a("code",[this._v("Spree::Calculator")]),this._v(".")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v('For example, if you create a new shipping method called "USPS Ground" that\ncharges a flat rate of $10 USD, you would be creating an instance of the\n'),a("code",[this._v("Spree::Calculator::Shipping::FlatRate")]),this._v(" calculator:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",[e("li",[t._v("The new calculator instance would have "),e("code",[t._v("calculable_type")]),t._v(" of\n"),e("code",[t._v("Spree::ShippingMethod")]),t._v(". This is because it has a polymorphic relationship\nwith a shipping method, rather than a tax rate or promotion action. See\n"),e("a",{attrs:{href:"#calculables"}},[t._v("calculables")]),t._v(" for more information about this relationship.")]),e("li",[t._v("The new calculator instance's "),e("code",[t._v("preferences")]),t._v(" attribute would have a value of\n"),e("code",[t._v('{:preference=>10, :currency=>"USD"}')]),t._v(".")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"attributes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attributes","aria-hidden":"true"}},[this._v("#")]),this._v(" Attributes")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[a("code",[this._v("Spree::Calculator")]),this._v(" objects have the following attributes:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",[e("li",[e("code",[t._v("type")]),t._v(": The type of calculator being used. For example, if the object\ncalculates shipping, it could be any available shipping calculator, such as\n"),e("code",[t._v("Spree::Calculator::Shipping::FlatRate")]),t._v(".")]),e("li",[e("code",[t._v("calculable_type")]),t._v(" and "),e("code",[t._v("calculable_id")]),t._v(": The calculable type and its matching\nID. For example, if the object calculates shipping, the calculable would be\nfrom the "),e("code",[t._v("Spree::ShippingMethod")]),t._v(" model. See "),e("a",{attrs:{href:"#calculables"}},[t._v("calculables")]),t._v(" for\nmore information.")]),e("li",[e("code",[t._v("preferences")]),t._v(": A hash of the calculator's preferences and the values of those\npreferences. Each type of calculator has its own preferences. See\n"),e("a",{attrs:{href:"#preferences"}},[t._v("preferences")]),t._v(" for more information.")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"calculables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calculables","aria-hidden":"true"}},[this._v("#")]),this._v(" Calculables")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("A calculable is an object that needs to be calculated by a "),a("code",[this._v("Spree::Calculator")]),this._v(".\nIn Rails, this is an example of a "),a("a",{attrs:{href:"http://guides.rubyonrails.org/association_basics.html#polymorphic-associations",target:"_blank",rel:"noopener noreferrer"}},[this._v("polymorphic association")]),this._v(":\nall calculators share a common base class, but they can calculate different\ntypes of objects.")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("In the case of "),a("code",[this._v("Spree::Calculator")]),this._v("s, there are three different\n"),a("code",[this._v("calculable_types")]),this._v(":")])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",[a("li",[a("code",[this._v("Spree::ShippingMethod")])]),a("li",[a("code",[this._v("Spree::TaxRate")])]),a("li",[a("code",[this._v("Spree::PromotionAction")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("A calculable "),a("code",[this._v("include")]),this._v("s the "),a("code",[this._v("Spree::CalculatedAdjustments")]),this._v(" module. This module\nrequires that each calculable has one calculator object. So, for each calculable\nobject, an instance of a "),a("code",[this._v("Spree::Calculator")]),this._v(" should also be created.")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v('For example, a shipping method called "USPS Ground" charges a flat rate of $10\nUSD. The shipping method is calculable and requires an associated calculator.\nSo, the rate for each shipment is calculated by the associated\n'),a("code",[this._v("Spree::Calculator::Shipping::FlatRate")]),this._v(" object.")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("Similarly, each tax rate in your store is calculable. So, instance of the\n"),a("code",[this._v("Spree::Calculator::DefaultTax")]),this._v(" calculator is created and calculates the amount\nof tax that should be applied to line items, shipments, or orders.")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"preferences"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preferences","aria-hidden":"true"}},[this._v("#")]),this._v(" Preferences")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("For example, you may have two flat shipping rates configured in your store.\nIf you look up each of  your "),a("code",[this._v("Spree::Calculator::Shipping::FlatRate")]),this._v(" calculators,\nyou can see how the static preferences have different settings:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("pre",{pre:!0,attrs:{class:"language-ruby"}},[e("code",[e("span",{attrs:{class:"token constant"}},[t._v("Spree")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Calculator")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Shipping")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("FlatRate")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("find")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token number"}},[t._v("1")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preferences\n"),e("span",{attrs:{class:"token comment"}},[t._v('# => {:amount=>8, :currency=>"USD"}')]),t._v("\n\n"),e("span",{attrs:{class:"token constant"}},[t._v("Spree")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Calculator")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Shipping")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("FlatRate")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("find")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token number"}},[t._v("2")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preferences\n"),e("span",{attrs:{class:"token comment"}},[t._v('# => {:amount=>4, :currency=>"EUR"}')]),t._v("\n")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("For example, a calculator that uses a percentage for calculations would not have\na "),a("code",[this._v(":currency")]),this._v(" preference, but any calculator that uses a specific amount of\ncurrency would have a "),a("code",[this._v(":currency")]),this._v(" preference::")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("pre",{pre:!0,attrs:{class:"language-ruby"}},[e("code",[e("span",{attrs:{class:"token constant"}},[t._v("Spree")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Calculator")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Shipping")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("FlatRate")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("find")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token number"}},[t._v("2")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preferences\n"),e("span",{attrs:{class:"token comment"}},[t._v('# => {:amount=>4, :currency=>"EUR"}')]),t._v("\n\n"),e("span",{attrs:{class:"token constant"}},[t._v("Spree")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Calculators")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Shipping")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("FlatPercentItemTotal")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("find")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token number"}},[t._v("3")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preferences\n"),e("span",{attrs:{class:"token comment"}},[t._v("# => {:flat_percent=>0.2e1}")]),t._v("\n")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{attrs:{id:"preferred-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preferred-methods","aria-hidden":"true"}},[this._v("#")]),this._v(" Preferred methods")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("For each preference on a calculator, you can use a "),a("code",[this._v("preferred_<preference>")]),this._v("\nmethod to get or set the value of the preference (where "),a("code",[this._v("<preference>")]),this._v(" is the\nname of the preference). For example")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("pre",{pre:!0,attrs:{class:"language-ruby"}},[e("code",[e("span",{attrs:{class:"token constant"}},[t._v("Spree")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{attrs:{class:"token constant"}},[t._v("Calculator")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("find")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token number"}},[t._v("1")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("update")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("preferred_amount"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token number"}},[t._v("20")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"custom-calculators"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#custom-calculators","aria-hidden":"true"}},[this._v("#")]),this._v(" Custom calculators")])}],!1,null,null,null);a.default=n.exports}}]);