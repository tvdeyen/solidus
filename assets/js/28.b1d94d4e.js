(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{66:function(t,e,s){"use strict";s.r(e);var n=s(0),a=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._m(1),s("p",[t._v("Typically, a promotion action could be free shipping or a fixed percentage\ndiscount.")]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),s("p",[t._v("Note that whenever an order, line item, or shipment with a promotion adjustment\non it is updated, the "),s("router-link",{attrs:{to:"overview.html#eligibility"}},[t._v("eligibility")]),t._v(" of the promotion is re-checked\nand the promotion actions are re-applied.")],1),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"promotion-actions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#promotion-actions","aria-hidden":"true"}},[this._v("#")]),this._v(" Promotion actions")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("code",[this._v("Spree::PromotionAction")]),this._v(" model defines an action that should occur if the\npromotion is activated and eligible to be applied. There can be multiple\npromotion actions on a promotion.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("A promotion action calculates the discount amount and creates a\n"),e("code",[this._v("Spree::Adjustment")]),this._v(" for the promotion. The adjustment then adjusts the price of\nan order, line item, or shipment.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("With the exception of "),e("code",[this._v("Spree::Promotion::Actions::FreeShipping")]),this._v(", promotion\nactions have a configurable base calculator. This gives you and store\nadministrators flexibility for choosing how a promotion amount is calculated.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"available-promotion-action-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#available-promotion-action-types","aria-hidden":"true"}},[this._v("#")]),this._v(" Available promotion action types")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The following classes are "),e("a",{attrs:{href:"https://github.com/solidusio/solidus/tree/master/core/app/models/spree/promotion/actions",target:"_blank",rel:"noopener noreferrer"}},[this._v("subclasses of the "),e("code",[this._v("Spree::Promotion::Actions")]),this._v("\nmodel")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("CreateAdjustment")]),t._v(": Creates a single adjustment associated to the current\n"),s("code",[t._v("Spree::Order")]),t._v(".")]),s("li",[s("code",[t._v("CreateItemAdjustments")]),t._v(": Creates an adjustment for each applicable\n"),s("code",[t._v("Spree::LineItem")]),t._v(" in the current order.")]),s("li",[s("code",[t._v("CreateQuantityAdjustments")]),t._v(": Creates per-quantity adjustments. For example,\nyou could create an action that gives customers a discount on each group of\nthree t-shirts that they order at once.")]),s("li",[s("code",[t._v("FreeShipping")]),t._v(": Creates an adjustment that negates all shipping charges.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("We recommend using "),e("code",[this._v("CreateItemAdjustments")]),this._v("s over "),e("code",[this._v("CreateAdjustment")]),this._v(". Over-level\nadjustments can make calculating accurate refunds and some regions's taxes more\ndifficult for administrators.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"eligibility"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eligibility","aria-hidden":"true"}},[this._v("#")]),this._v(" Eligibility")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"register-a-custom-promotion-action"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-a-custom-promotion-action","aria-hidden":"true"}},[this._v("#")]),this._v(" Register a custom promotion action")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You can create a new promotion action for Solidus by creating a new class that\ninherits from "),e("code",[this._v("Spree::PromotionAction")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("pre",{pre:!0,attrs:{class:"language-ruby"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("# app/models/spree/promotion/actions/my_promotion_action.rb")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("module")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Spree")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Promotion")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("module")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Actions")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MyPromotionAction")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("Spree")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token constant"}},[t._v("PromotionAction")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("perform")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("remove_from")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Your promotion action must implement the "),e("code",[this._v("perform(options = {})")]),this._v(" method. This\nmethod should return a boolean that declares whether the action was applied\nsuccessfully. It is also recommend to define a "),e("code",[this._v("remove_from(order)")]),this._v(" method as\nwell. See the\n"),e("a",{attrs:{href:"https://github.com/solidusio/solidus/blob/master/core/app/models/spree/promotion/actions/create_item_adjustments.rb",target:"_blank",rel:"noopener noreferrer"}},[e("code",[this._v("Spree::Promotion::Actions::CreateItemAdjustments")])]),this._v("\nclass for an example of these method definitions.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You must then register the custom action in an initializer in your\n"),e("code",[this._v("config/initializers/")]),this._v(" directory:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("pre",{pre:!0,attrs:{class:"language-ruby"}},[s("code",[s("span",{attrs:{class:"token constant"}},[t._v("Rails")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("application"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spree"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("promotions"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("actions "),s("span",{attrs:{class:"token operator"}},[t._v("<")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("MyPromotionAction")]),t._v("\n")])])}],!1,null,null,null);e.default=a.exports}}]);